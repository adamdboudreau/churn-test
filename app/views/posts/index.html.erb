<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<p id="notice"><%= notice %></p>

<h1>Posts</h1>

<table>
  <thead>
    <tr>
      <th>Content</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <td><%= post.content %></td>
        <td><%= link_to 'Show', post %></td>
        <td><%= link_to 'Edit', edit_post_path(post) %></td>
        <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Post', new_post_path %>

<br>

<%= link_to 'Test', test_request_path %><br/>
<%= link_to 'Get Churn', get_churn_path(scrollspeed: 180, towardsaddressbar: 0) %><br/>
<div class="tester">tester<br/>test</div><br/>
<div class="getchurn">getchurn</div><br/>
<script>
  $('.getchurn').on('click', function () {
    console.log('get churn');
    $.get({
      url: '<%= get_churn_path(scrollspeed: 10, towardsaddressbar: 0) %>',
          data: {},
        success: function (data) {
          console.log('success');
          console.log(data);
          console.log(data['Results']['output1']['value']['Values'][0][0]);
        }
    });
  });
  $('.tester').on('click', function () {
    console.log('test request');
    var token = 'dyvc/hRs3H2Vgg/mhE3G8ZqenCpStb0Kq3dZKh8GAp2LR3ciNcpNhIeF8vt+O3xqTtuCS5P1PAoS3vtl5ds7WA==',
        url = 'https://ussouthcentral.services.azureml.net/workspaces/dbbfd492f47242058f1db7c3a877e75f/services/2be44fe3833346d687602bf35ace4f4a/execute?api-version=2.0&details=true',
        input_data = {
//        'access': token,
//        'headers': {'Authorization:Bearer': token, 'Authorization': token, 'Content-Type': 'application/json'},
      "Inputs": {
        "input1": {
          "ColumnNames": [
            "scrollspeed",
            "towardsaddressbar",
            "churn"
          ],
          "Values": [
            [
              "120",
              "0",
              "0"
            ],
            [
              "0",
              "1",
              "0"
            ]
          ]
        }
      },
      "GlobalParameters": {}
    };
//      console.log(input_data);
//      $.ajax(url, {
//          url: url,
//          method: 'POST',
//          type: 'POST',
//          data: input_data,
//          dataType: 'json',
//          crossDomain: true,
//  //        beforeSend: function(xhr) {xhr.setRequestHeader('Authorization', token);},
//          headers: {'Authorization': token, 'Content-Type': 'application/json'},
//          complete: function (data, b, c, d)
//          {
//            console.log('success');
//            console.log(data);
//            console.log(b);
//            console.log(c);
//            console.log(d);
//          },
//            error: function (data, b, c, d) {
//            console.log('error');
//            console.log(data);
//            console.log(b);
//            console.log(c);
//            console.log(d);
//          }
//      });

    $.ajax({
      url: url,
      method: 'POST',
      data: '{"Inputs": {"input1": {"ColumnNames": ["scrollspeed","towardsaddressbar","churn"],"Values": [["120","0","0"],["0","1","0"]]}},"GlobalParameters": {}}',
      crossDomain: true,
      beforeSend: function(xhr) {
        xhr.setRequestHeader('Authorization', token);xhr.setRequestHeader('Content-Type', 'application/json');
xhr.setRequestHeader('Access-Control-Allow-Origin', '*');xhr.setRequestHeader('Access-Control-Allow-Methods', 'POST, GET');xhr.setRequestHeader('Access-Control-Max-Age', 1000);xhr.setRequestHeader('Access-Control-Allow-Headers', 'origin, x-csrftoken, content-type, accept');
      },
      headers: {'Authorization': token, 'Content-Type': 'application/json',
        'Access-Control-Allow-Origin': '*', 'Access-Control-Allow-Methods': 'POST, GET',
        'Access-Control-Max-Age': 1000, 'Access-Control-Allow-Headers': 'origin, x-csrftoken, content-type, accept'},
      complete: function (data, b, c, d) {
        console.log('success');
        console.log(data);
        console.log(b);
        console.log(c);
        console.log(d);
      },
      error: function (data, b, c, d) {
        console.log('error');
        console.log(data);
        console.log(b);
        console.log(c);
        console.log(d);
      }
    });
  });
</script>
